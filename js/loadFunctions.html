<script>

// load functions here

function loadSlideshow(){

    clearStatus();

    var album = document.getElementById('albums').value;

    if (album == 0){

        updateStatus({
            statusSubtitle: "Warning!",
            statusMessage: "You haven't selected an album to view",
        });

        return;
    }

    google.script.run.withSuccessHandler((params) => {

        if (params.errorMessage){
            updateStatus({
                statusSubtitle: "Warning!",
                statusMessage: params.errorMessage,
            });
            return;
        }

        var pageContent = `    
        <!-- Slideshow container -->
            <div class="slideshow-container">

            <!-- Full-width images with number and caption text -->
        `;

        for (var i=0; i<params.imageArray.length; i++){
            var imageNum = i+1;
            var length = params.imageArray.length;
            var url = "https://lh3.googleusercontent.com/d/" + params.imageArray[i];

            pageContent += `
                <div class="mySlides fade">
                    <div class="numbertext">${imageNum} / ${length}</div>
                    <a href="${url}" target="_blank" border="0"><img src="${url}" style="width:600px"></a>
                    <!-- <div class="text">Caption Text</div> -->
                </div>            
            `;
        }

        pageContent += `
            <!-- Next and previous buttons -->
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>
            </div>
            <br>

        `;

        document.getElementById('pageContent').innerHTML = pageContent;
        currentSlide(1);
    }).withFailureHandler(() => {
        updateStatus({
            statusSubtitle: "Warning!",
            statusMessage: "failed to get photos",
        });
    }).getPhotos(album);
    
}

</script>